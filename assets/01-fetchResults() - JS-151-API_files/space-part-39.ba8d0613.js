webpackJsonp([59],{"./core/models/Asset.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i,a;var s=r("./node_modules/immutable/dist/immutable.js");var u=r("../node_modules/path-browserify/index.js");var c=y(u);var l=r("./core/models/database/index.js");var f=r("./core/models/BlobMetadata.js");var p=y(f);var d=r("./core/models/GitHubFileState.js");var h=y(d);function y(e){return e&&e.__esModule?e:{default:e}}function m(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i);var s=a.value}catch(e){r(e);return}if(!a.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}return n("next")})}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function g(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var D=(a=i=function(e){g(t,e);function t(){b(this,t);return v(this,e.apply(this,arguments))}t.create=function e(r){if(r instanceof t)return r;return new t(n({},r,{uid:r.uid||(0,l.genKey)(),createdAt:new Date(r.createdAt||Date.now()),lastModifiedAt:new Date(r.lastModifiedAt||Date.now()),github:r.github?h.default.create(r.github):null}))};t.createFromFile=function e(r){return t.create({name:r.name}).updateFromBlob(r)};t.deserialize=function e(r){return new t({uid:r.uid,name:r.name,downloadURL:r.downloadURL||null,blobSize:r.size,contentType:r.contentType,createdAt:new Date(r.createdAt),lastModifiedAt:new Date(r.lastModifiedAt),modifiedBy:(0,s.Set)(r.modifiedBy),github:r.github?h.default.create(r.github):null})};t.prototype.serialize=function e(){return{uid:this.uid,name:this.name,downloadURL:this.downloadURL,size:this.blobSize,contentType:this.contentType||p.default.MIME_TYPE_DEFAULT,createdAt:this.createdAt.getTime(),lastModifiedAt:this.lastModifiedAt.getTime(),modifiedBy:this.modifiedBy.toJSON(),github:this.github?this.github.serialize():null}};t.prototype.asBlob=function(){var e=m(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function e(n){while(1)switch(n.prev=n.next){case 0:n.next=2;return fetch(this.downloadURL);case 2:t=n.sent;n.next=5;return t.blob();case 5:r=n.sent;return n.abrupt("return",r);case 7:case"end":return n.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}();t.prototype.updateFromBlob=function e(t){var r=URL.createObjectURL(t);return this.merge({blobSize:t.size,contentType:t.type,downloadURL:r})};t.prototype.markAsModifiedBy=function e(t){return this.merge({lastModifiedAt:new Date,modifiedBy:this.modifiedBy.add(t.uid)})};t.prototype.updateWithMetadata=function e(t){return this.merge({name:t.name,downloadURL:t.downloadURL,createdAt:t.createdAt,lastModifiedAt:t.lastModifiedAt,blobSize:t.blobSize,contentType:t.contentType})};o(t,[{key:"extension",get:function e(){return c.default.extname(this.name).toLowerCase()}},{key:"isImage",get:function e(){return Boolean(this.contentType&&this.contentType.startsWith("image/"))}},{key:"isSvg",get:function e(){return this.contentType===p.default.MIME_TYPE_SVG}},{key:"isUploaded",get:function e(){return!this.downloadURL.startsWith("blob:")}}]);return t}((0,s.Record)({uid:"",name:"",downloadURL:null,blobSize:0,createdAt:new Date,lastModifiedAt:new Date,modifiedBy:(0,s.Set)(),github:null,contentType:null})),i.MAX_SIZE=10485760,a);t.default=D},"./core/models/AuthUser.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i,a;var s=r("./node_modules/btoa/index.js");var u=h(s);var c=r("./node_modules/immutable/dist/immutable.js");var l=r("./node_modules/jwt-decode/lib/index.js");var f=h(l);var p=r("./core/models/User.js");var d=h(p);function h(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function b(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=(a=i=function(e){b(t,e);function t(){y(this,t);return m(this,e.apply(this,arguments))}t.createFromFirebase=function e(r){return new t({live:true,uid:r.uid,email:r.email,emailVerified:Boolean(r.emailVerified),disabled:Boolean(r.disabled),phoneNumber:r.phoneNumber,displayName:t.normalizeName(r.displayName||t.getNameFromEmail(r.email)),photoURL:r.photoURL||"",refreshToken:r.refreshToken||null,providers:(r.providerData||[]).reduce(function(e,t){return e.set(t.providerId,{})},(0,c.Map)()),customClaims:(0,c.Map)(r.customClaims),isVisitor:r.uid===t.VISITOR_UID,createdAt:new Date(r.metadata.creationTime||Date.now()-864e5),lastLoggedInAt:new Date(r.metadata.lastSignInTime||Date.now())})};t.createVisitor=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{uid:""},n=r.uid;return new t({uid:n,live:true,isVisitor:true})};t.isLegacyID=function e(t){return Boolean(t.match(/^[0-9a-fA-F]{24}$/))};t.getAuthorizationHeader=function e(t,r){return"Basic "+(0,u.default)(t+":"+r)};t.normalizeName=function e(t){return t.slice(0,64)};t.getNameFromEmail=function e(t){return t?t.split("@")[0].split(".")[0]:""};t.prototype.isSSOUserFrom=function e(t){var r=this.customClaims.get("sso");return!!r&&r===t};t.prototype.updateDisplayName=function e(r){return this.merge({displayName:t.normalizeName(r||t.getNameFromEmail(this.email))})};t.prototype.updateBio=function e(r){return this.merge({bio:r.substring(0,t.BIO_MAX_LENGTH)})};t.prototype.setIdToken=function e(t){var r=(0,f.default)(t);return this.merge({customClaims:(0,c.Map)({intercomHash:r.intercomHash,siteAdmin:r.siteAdmin,riskScore:r.riskScore,sso:r.sso,secretToken:r.secretToken}),idToken:t})};t.prototype.mergeWithUser=function e(r){if(r.uid!=this.uid)throw new Error("Can't merge users with distinct uid");return this.merge({bio:r.bio,displayName:t.normalizeName(r.displayName||this.displayName),photoURL:r.photoURL})};t.prototype.toUser=function e(){return d.default.create({uid:this.uid,bio:this.bio,displayName:this.displayName,photoURL:this.photoURL,lastLoggedInAt:this.lastLoggedInAt})};t.deserialize=function e(r){return new t(n({},r,{customClaims:(0,c.Map)(r.customClaims),providers:(0,c.Map)(r.providers),createdAt:new Date(r.createdAt),lastLoggedInAt:new Date(r.lastLoggedInAt)}))};t.prototype.serialize=function e(){return{uid:this.uid,email:this.email,emailVerified:this.emailVerified,disabled:this.disabled,bio:this.bio,displayName:this.displayName,photoURL:this.photoURL,refreshToken:this.refreshToken,idToken:this.idToken,providers:this.providers.toObject(),isVisitor:this.isVisitor,customClaims:this.customClaims.toJS(),createdAt:this.createdAt.getTime(),lastLoggedInAt:this.lastLoggedInAt.getTime()}};o(t,[{key:"riskScore",get:function e(){return this.customClaims.get("riskScore")}},{key:"risk",get:function e(){var t=this.riskScore;if("number"!=typeof t)return"unknown";if(t<50)return"low";if(t<75)return"medium";return"high"}},{key:"isRisky",get:function e(){return"high"==this.risk}},{key:"requireVerification",get:function e(){return!this.isVerified&&!this.isSSOUser&&this.isRisky}},{key:"isLegacy",get:function e(){return t.isLegacyID(this.uid)}},{key:"authorizationHeader",get:function e(){return this.isLoggedIn&&this.idToken?t.getAuthorizationHeader(this.uid,this.idToken):null}},{key:"isLoggedIn",get:function e(){return Boolean(!this.isVisitor&&this.uid)}},{key:"hasPassword",get:function e(){return this.providers.has("password")}},{key:"hasGithubProvider",get:function e(){return this.providers.has("github.com")}},{key:"hasGoogleProvider",get:function e(){return this.providers.has("google.com")}},{key:"hasPhoneVerified",get:function e(){return this.providers.has("phone")}},{key:"isVerified",get:function e(){return this.emailVerified||this.hasPhoneVerified}},{key:"isSiteAdmin",get:function e(){return Boolean(this.customClaims.get("siteAdmin"))}},{key:"isSSOUser",get:function e(){return Boolean(this.customClaims.get("sso"))}}]);return t}((0,c.Record)({live:false,isVisitor:false,uid:"",email:"",emailVerified:false,disabled:false,phoneNumber:null,bio:"",displayName:"",photoURL:"",idToken:null,refreshToken:null,providers:(0,c.Map)(),customClaims:(0,c.Map)(),createdAt:new Date,lastLoggedInAt:new Date})),i.VISITOR_UID="visitor",i.BIO_MAX_LENGTH=d.default.BIO_MAX_LENGTH,a);t.default=v},"./core/models/BillingAddress.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=r("./node_modules/immutable/dist/immutable.js");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(e){s(t,e);function t(){i(this,t);return a(this,e.apply(this,arguments))}t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(n({},r))};t.deserialize=function e(r){return t.create(r)};t.prototype.serialize=function e(){return{firstName:this.firstName,lastName:this.lastName,email:this.email,phone:this.phone,organization:this.organization,street:this.street,country:this.country,region:this.region,city:this.city,zip:this.zip,vat:this.vat}};return t}((0,o.Record)({firstName:"",lastName:"",email:"",phone:"",organization:"",street:"",country:"",region:"",city:"",zip:"",vat:""}));t.default=u},"./core/models/BillingCard.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=r("./node_modules/immutable/dist/immutable.js");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(e){s(t,e);function t(){i(this,t);return a(this,e.apply(this,arguments))}t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(n({},r))};t.deserialize=function e(r){return t.create(r)};t.prototype.serialize=function e(){return{brand:this.brand,last4:this.last4,expMonth:this.expMonth,expYear:this.expYear}};return t}((0,o.Record)({brand:"",last4:"",expMonth:0,expYear:0}));t.default=u},"./core/models/BillingConfig.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=r("./core/constants/BILLING.js");var i=r("./core/models/database/index.js");var a=r("./core/models/BillingCard.js");var s=l(a);var u=r("./core/models/BillingAddress.js");var c=l(u);function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h=function(e){d(t,e);function t(){f(this,t);return p(this,e.apply(this,arguments))}t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(n({},r,{billingAddress:c.default.create(r.billingAddress),card:s.default.create(r.card),createdAt:new Date(r.createdAt||new Date),updatedAt:new Date(r.updatedAt||new Date)}))};t.queryByID=function e(t){return this.query("billingConfig").doc(t)};t.prototype.query=function e(){return t.queryByID(this.orgID)};t.deserialize=function e(r){return t.create(r)};t.prototype.isLegacyPlan=function e(){var t=this;return this.plan&&Boolean(o.LEGACY_PLANS.find(function(e){return e===t.plan}))};t.prototype.isUpgrade=function e(r){return t.isUpgrade(r.plan,this.plan)};t.prototype.isDowngrade=function e(r){return t.isDowngrade(r.plan,this.plan)};t.computeOvercharge=function e(t){var r=t.plan,n=t.members;var i=o.BILLING_SPEC[r];if(!i)return 0;var a=o.BILLING_SPEC[r].membersIncluded?n-o.BILLING_SPEC[r].membersIncluded:n;return a>0?a*i.priceByMemberMonthly:0};t.prototype.serialize=function e(){return{orgID:this.orgID,billingAddress:this.billingAddress.serialize(),activePlan:this.activePlan,plan:this.plan,customerID:this.customerID,subscriptionID:this.subscriptionID,cardID:this.cardID,token:this.token,card:this.card&&this.card.serialize(),coupon:this.coupon,createdAt:this.createdAt.getTime(),updatedAt:this.updatedAt.getTime(),error:this.error}};t.isUpgrade=function e(t,r){var n=o.PLANS.indexOf(t);var i=o.PLANS.indexOf(r);return i>n};t.isDowngrade=function e(t,r){var n=o.PLANS.indexOf(t);var i=o.PLANS.indexOf(r);return i<n};return t}((0,i.DatabaseModel)("billingConfig",{orgID:"",billingAddress:c.default.create(),plan:"free",activePlan:"free",customerID:null,subscriptionID:null,cardID:null,token:null,card:null,coupon:null,createdAt:new Date,updatedAt:new Date,error:null}));t.default=h},"./core/models/BlobMetadata.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n,o;var i=r("../node_modules/path-browserify/index.js");var a=u(i);var s=r("./node_modules/immutable/dist/immutable.js");function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function f(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=(o=n=function(e){f(t,e);function t(){c(this,t);return l(this,e.apply(this,arguments))}t.createFromFirebase=function e(r,n){return new t({name:a.default.basename(r.name),contentType:r.contentType,downloadURL:n,blobSize:r.size,createdAt:new Date(r.timeCreated),lastModifiedAt:new Date(r.updated)})};t.createFromGCloud=function e(r){var n=r.mediaLink.replace("https://www.googleapis.com/download/storage/v1/b/","https://firebasestorage.googleapis.com/v0/b/");return new t({name:a.default.basename(r.name),contentType:r.contentType,downloadURL:n,blobSize:+r.size,createdAt:new Date(r.timeCreated),lastModifiedAt:new Date(r.updated)})};return t}((0,s.Record)({name:"",contentType:"",downloadURL:"",blobSize:0,createdAt:new Date,lastModifiedAt:new Date})),n.MIME_TYPE_DEFAULT="application/octet-stream",n.MIME_TYPE_JSON="application/json",n.MIME_TYPE_SVG="image/svg+xml",o);t.default=p},"./core/models/Config.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./node_modules/immutable/dist/immutable.js");function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function u(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c={firebase:{projectId:"",apiKey:"",authDomain:"",databaseURL:"",storageBucket:"",messagingSenderId:""},hotjar:{site_id:""},algolia:{appid:""},iframely:{key:""},mixpanel:{token:"",orgs_token:""},helpscout:{form_id:""},slack:{client_id:"",redirect_uri:""},ga:{spaces:{id:"",view_id:""},website:{id:""}},sentry:{url:""},stripe:{public_key:""},urls:{api:"",spaces:"",website:""},domains:{spaces:""},cdn:{blobsurl:""},clearbit:{public_key:""},statuspage:{domain:""},version:""};var l=function(e){u(t,e);function t(){a(this,t);return s(this,e.apply(this,arguments))}t.deserialize=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(n({},r))};t.prototype.serialize=function e(){return this.toJSON()};o(t,[{key:"isProd",get:function e(){return Boolean(this.domains.spaces)}},{key:"isDev",get:function e(){return!this.isProd}}]);return t}((0,i.Record)(c));t.default=l},"./core/models/CustomDomain.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var o=r("./core/models/database/index.js");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(e){s(t,e);function t(){i(this,t);return a(this,e.apply(this,arguments))}t.queryByDomain=function e(t){return this.query("domains").doc((0,o.escapeKey)(t))};t.prototype.query=function e(){return t.queryByDomain(this.domain)};t.createFromOrg=function e(r){if(!r.customDomain)return null;return new t({orgID:r.uid,domain:r.customDomain})};t.createFromSpace=function e(r){if(!r.customDomain)return null;return new t({orgID:r.orgID,spaceID:r.uid,domain:r.customDomain})};t.deserialize=function e(r){return new t({orgID:r.orgID,spaceID:r.spaceID||null,domain:r.domain,deprecated:r.deprecated})};t.prototype.serialize=function e(){return{orgID:this.orgID,spaceID:this.spaceID,domain:this.domain,deprecated:this.deprecated}};n(t,[{key:"escapedDomain",get:function e(){return(0,o.escapeKey)(this.domain)}}]);return t}((0,o.DatabaseModel)("customDomain",{orgID:"",spaceID:null,domain:"",deprecated:false}));t.default=u},"./core/models/Draft.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./core/models/database/index.js");function a(e,t){var r={};for(var n in e){if(t.indexOf(n)>=0)continue;if(!Object.prototype.hasOwnProperty.call(e,n))continue;r[n]=e[n]}return r}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function c(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(e){c(t,e);function t(){s(this,t);return u(this,e.apply(this,arguments))}t.queryBySpace=function e(t){return this.query(["spaces",t,"drafts"])};t.queryByID=function e(t){var r=t.spaceID,n=t.draftID;return this.queryBySpace(r).doc(n)};t.prototype.query=function e(r){return t.queryByID({spaceID:r,draftID:this.uid})};t.create=function e(r){if(r instanceof t)return r;var o=r.revisionInitial,s=r.createdBy,u=r.uid,c=a(r,["revisionInitial","createdBy","uid"]);return new t(n({createdBy:s,createdAt:new Date,lastModifiedAt:new Date,revisionInitial:o,revisionCurrent:o,uid:u||(0,i.genKey)()},c))};t.deserialize=function e(r){return new t({uid:r.uid,title:r.title,createdAt:new Date(r.createdAt),lastModifiedAt:new Date(r.lastModifiedAt),closedAt:r.closedAt?new Date(r.closedAt):null,createdBy:r.createdBy,revisionCurrent:r.revisionCurrent,revisionInitial:r.revisionInitial,revisionPublishedAncestor:r.revisionPublishedAncestor||r.revisionBase||r.revisionInitial,revisionMerged:r.revisionMerged||null})};t.prototype.serialize=function e(){return{uid:this.uid,title:this.title,createdAt:this.createdAt.getTime(),lastModifiedAt:this.lastModifiedAt.getTime(),closedAt:this.closedAt?this.closedAt.getTime():null,createdBy:this.createdBy,revisionCurrent:this.revisionCurrent,revisionInitial:this.revisionInitial,revisionPublishedAncestor:this.revisionPublishedAncestor,revisionMerged:this.revisionMerged}};t.prototype.authorizeAs=function e(t){return this.merge({createdBy:t.uid,createdAt:new Date,lastModifiedAt:new Date})};t.prototype.markAsModified=function e(){return this.merge({lastModifiedAt:new Date})};t.prototype.markAsClosed=function e(){return this.merge({closedAt:new Date})};t.prototype.markAsMerged=function e(t,r){return this.merge({closedAt:new Date,revisionPublishedAncestor:t,revisionMerged:r})};t.prototype.toCreateUpdate=function e(r){return(new i.DatabaseUpdate).set(t.queryByID({spaceID:r,draftID:this.uid}),this)};t.prototype.toUpdate=function e(t){return this.toCreateUpdate(t)};o(t,[{key:"isOpened",get:function e(){return!this.isClosed}},{key:"isClosed",get:function e(){return null!=this.closedAt}},{key:"isMerged",get:function e(){return null!=this.revisionMerged}},{key:"isArchived",get:function e(){return this.isClosed&&!this.isMerged}},{key:"isInitial",get:function e(){return this.revisionCurrent===this.revisionInitial}},{key:"hasChanges",get:function e(){return""!==this.title||!this.isInitial}}]);return t}((0,i.DatabaseModel)("draft",{uid:"",title:"",createdAt:new Date,lastModifiedAt:new Date,closedAt:null,createdBy:"",revisionCurrent:"",revisionInitial:"",revisionPublishedAncestor:"",revisionMerged:null}));t.default=l},"./core/models/GitHubCommitState.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./node_modules/immutable/dist/immutable.js");function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function u(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=function(e){u(t,e);function t(){a(this,t);return s(this,e.apply(this,arguments))}t.normalizeMessage=function e(t){return t.split("\n")[0].slice(0,100)};t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r instanceof t)return r;return new t(n({},r,{message:r.message&&t.normalizeMessage(r.message),ref:r.ref?r.ref:null}))};t.deserialize=function e(r){return t.create(r)};t.prototype.serialize=function e(){return{repoID:this.repoID,sha:this.sha,ref:this.ref,message:this.message,isGitBookBot:this.isGitBookBot}};o(t,[{key:"treeUrl",get:function e(){return"https://github.com/"+this.repoID+"/tree/"+this.sha+"/"}}]);return t}((0,i.Record)({repoID:"",sha:"",message:"",ref:null,isGitBookBot:false}));t.default=c},"./core/models/GitHubConfig.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i,a;var s=r("./node_modules/immutable/dist/immutable.js");var u=r("./node_modules/glob-to-regexp/index.js");var c=y(u);var l=r("./core/models/database/index.js");var f=r("./core/models/Space.js");var p=y(f);var d=r("./core/models/GitHubSyncStatus.js");var h=y(d);function y(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function v(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g={GITBOOK:"gitbook",GITHUB:"github"};var D=(a=i=function(e){v(t,e);function t(){m(this,t);return b(this,e.apply(this,arguments))}t.queryBySpace=function e(t){return this.query("spaces/"+t).doc("github/config")};t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(n({},r,{createdAt:r.createdAt||new Date}))};t.deserialize=function e(r){return new t(n({},r,{importBranchesFilter:(0,s.List)(r.importBranchesFilter),createdAt:new Date(r.createdAt)}))};t.prototype.query=function e(r){return t.queryBySpace(r)};t.prototype.serialize=function e(){return{repoID:this.repoID,token:this.token,hookID:this.hookID,importBranchesFilter:this.importBranchesFilter.toArray(),priority:this.priority,createdBy:this.createdBy,createdAt:this.createdAt.getTime()}};t.prototype.asTaskConfig=function e(){return{repoID:this.repoID,authToken:this.token}};t.prototype.shouldImportRef=function e(t){var r=0===t.indexOf("refs/heads/");if(!r)return false;var n=t.replace(/^refs\/heads\//,"");var o=this.importBranchesFilter.some(function(e){var t=(0,c.default)(e);return t.test(n)});return o};t.prototype.toCreateUpdate=function e(r){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(new l.DatabaseUpdate).set(t.queryBySpace(r),this).update(p.default.queryByID(r),{hasGitHubSync:true,editOnGitHub:n?this.repoID:null})};t.prototype.toUpdate=function e(r){return(new l.DatabaseUpdate).set(t.queryBySpace(r),this)};t.prototype.toRemoveUpdate=function e(r){return(new l.DatabaseUpdate).delete(t.queryBySpace(r)).merge(h.default.clearStatusesUpdate(r)).update(p.default.queryByID(r),{hasGitHubSync:false,editOnGitHub:null})};o(t,[{key:"githubOwner",get:function e(){var t=this.repoID.split("/");return t[0]}},{key:"githubRepo",get:function e(){var t=this.repoID.split("/");return t[1]}}]);return t}((0,l.DatabaseModel)("githubConfig",{repoID:"",token:"",hookID:null,importBranchesFilter:(0,s.List)(["master"]),priority:g.GITHUB,createdBy:"",createdAt:new Date})),i.MAX_BRANCHES=10,i.PRIORITIES=g,a);t.default=D},"./core/models/GitHubSyncStatus.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./node_modules/immutable/dist/immutable.js");var a=r("./core/models/database/index.js");var s=r("./core/models/GitHubSyncTask.js");var u=c(s);function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function p(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var d=72e5;var h=function(e){p(t,e);function t(){l(this,t);return f(this,e.apply(this,arguments))}t.create=function e(r){return new t(n({},r,{createdAt:r.createdAt||new Date}))};t.queryBySpace=function e(t){return this.query(["spaces",t,"github/statuses"])};t.queryByID=function e(t){var r=t.spaceID,n=t.revisionID;return this.queryBySpace(r).doc(n)};t.clearStatusesUpdate=function e(r){return(new a.DatabaseUpdate).deleteCollection(t.queryBySpace(r))};t.prototype.query=function e(r){return t.queryByID({revisionID:this.revisionID,spaceID:r})};t.prototype.toUpdate=function e(t){return(new a.DatabaseUpdate).set(this.query(t),this)};t.prototype.addTasks=function e(t){var r=t.reduce(function(e,t){return e.set(t.taskID,t)},(0,i.Map)());return this.merge({tasks:this.tasks.merge(r)})};t.prototype.markTaskAsCompleted=function e(t,r){return this.merge({tasks:this.tasks.set(t,this.tasks.get(t).markAsCompleted(r))})};t.deserialize=function e(r){return new t({type:r.type,revisionID:r.revisionID,createdAt:new Date(r.createdAt),repoID:r.repoID,tasks:(0,i.Map)(r.tasks||{}).map(function(e){return u.default.deserialize(e)})})};t.prototype.serialize=function e(){return{type:this.type,revisionID:this.revisionID,createdAt:this.createdAt.getTime(),repoID:this.repoID,tasks:this.tasks.map(function(e){return e.serialize()}).toJS()}};o(t,[{key:"hasFinished",get:function e(){var t=this.tasks.size;return t>0&&t===this.completedTasks.size}},{key:"hasSucceeded",get:function e(){return this.hasFinished&&!this.hasError}},{key:"hasTimeout",get:function e(){return new Date-this.createdAt>d||"undefined"===typeof this.type}},{key:"hasError",get:function e(){return!!this.error}},{key:"progress",get:function e(){var t=this.tasks.size;return 0===t?0:100*this.completedTasks.size/t}},{key:"error",get:function e(){var t=this.tasks.find(function(e){return e.hasError});return t?t.error:null}},{key:"completedTasks",get:function e(){return this.tasks.filter(function(e){return e.isCompleted})}}]);return t}((0,a.DatabaseModel)("githubSyncStatus",{type:"import",revisionID:"",createdAt:new Date,repoID:"",tasks:(0,i.Map)()}));t.default=h},"./core/models/GitHubSyncTask.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./node_modules/immutable/dist/immutable.js");var a=r("./core/models/database/index.js");function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function c(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(e){c(t,e);function t(){s(this,t);return u(this,e.apply(this,arguments))}t.create=function e(r){return new t({taskID:(0,a.genKey)(),payload:r})};t.deserialize=function e(r){return new t({taskID:r.taskID,payload:r.payload?JSON.parse(r.payload):{},startedAt:new Date(r.startedAt),completedAt:r.completedAt?new Date(r.completedAt):null,error:r.error||null})};t.toCompletedUpdate=function e(r,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;var i=new t({taskID:n}).markAsCompleted(o).serialize();return(new a.DatabaseUpdate).updateProperty(r,"tasks/"+i.taskID+"/completedAt",i.completedAt).updateProperty(r,"tasks/"+i.taskID+"/error",i.error)};t.filterPayload=function e(t){var r=t.type;var o=[];switch(r){case"import/page":case"export/page":o.push("versionID","pageID");break;case"import/asset":case"export/asset":o.push("assetID");break;case"export/version":o.push("versionID");break;default:break}return n({type:r,revisionID:t.revisionID},o.reduce(function(e,r){e[r]=t[r];return e},{}))};t.prototype.toMessage=function e(t,r){var n=this.taskID,o=this.payload;return{taskID:n,spaceID:t,repo:r,payload:o}};t.prototype.serialize=function e(){return{taskID:this.taskID,payload:JSON.stringify(t.filterPayload(this.payload)),startedAt:this.startedAt.getTime(),completedAt:this.completedAt?this.completedAt.getTime():null,error:this.error||null}};t.prototype.markAsCompleted=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;var r=null;t&&(r=t.expose?t.message:"Unexpected error");return this.merge({completedAt:new Date,error:r})};t.prototype.toCreateUpdate=function e(t){return(new a.DatabaseUpdate).updateProperty(t,"tasks/"+this.taskID,this.serialize())};o(t,[{key:"isCompleted",get:function e(){return!!this.completedAt}},{key:"hasError",get:function e(){return!!this.error}},{key:"hasSucceeded",get:function e(){return this.isCompleted&&!this.hasError}}]);return t}((0,i.Record)({taskID:"",payload:{},startedAt:new Date,completedAt:null,error:null}));t.default=l},"./core/models/Invite.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./node_modules/object.values/index.js");var a=f(i);var s=r("./node_modules/immutable/dist/immutable.js");var u=r("./core/models/database/index.js");var c=r("./core/constants/ROLES.js");var l=f(c);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var y=function(e){h(t,e);function t(){p(this,t);return d(this,e.apply(this,arguments))}t.create=function e(r){var n=r.role,o=r.teamID;return new t({uid:(0,u.genKey)(),teamID:o||null,role:n})};t.queryByOrg=function e(t){return this.query(["orgs",t,"invites"])};t.queryByID=function e(t){var r=t.orgID,n=t.inviteID;return this.queryByOrg(r).doc(n)};t.prototype.query=function e(r){return t.queryByID({orgID:r,inviteID:this.uid})};t.getNewInvitesMap=function e(r){return(0,a.default)(l.default).reduce(function(e,n){var o=t.create({role:n,teamID:r});return e.set(o.uid,o)},(0,s.Map)())};t.getNewInvitesUpdate=function e(r,n){var o=new u.DatabaseUpdate;var i=t.getNewInvitesMap(n);i.forEach(function(e){o.set(e.query(r),e)});return o};t.deserialize=function e(r){return new t(n({},r,{createdAt:new Date(r.createdAt)}))};t.prototype.serialize=function e(){return{uid:this.uid,role:this.role,teamID:this.teamID,createdAt:this.createdAt.getTime()}};o(t,[{key:"isTeam",get:function e(){return Boolean(this.teamID)}},{key:"canEdit",get:function e(){return/^(writer|reviewer|admin)$/.test(this.role)}},{key:"canReview",get:function e(){return/^(reviewer|admin)$/.test(this.role)}},{key:"canAdmin",get:function e(){return this.role==l.default.ADMIN}}]);return t}((0,u.DatabaseModel)("invite",{uid:"",role:"reader",createdAt:new Date,teamID:null}));t.default=y},"./core/models/Membership.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./node_modules/object.values/index.js");var a=y(i);var s=r("./node_modules/immutable/dist/immutable.js");var u=r("./core/models/database/index.js");var c=r("./core/models/UserMembership.js");var l=y(c);var f=r("./core/models/TeamMembership.js");var p=y(f);var d=r("./core/constants/ROLES.js");var h=y(d);function y(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function v(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=function(e){v(t,e);function t(){m(this,t);return b(this,e.apply(this,arguments))}t.queryByOrg=function e(t){return this.query(["orgs",t,"members"])};t.queryByID=function e(t){var r=t.orgID,n=t.userID;return this.queryByOrg(r).doc(n)};t.prototype.query=function e(r){return t.queryByID({orgID:r,userID:this.uid})};t.prototype.canReadSpace=function e(t){return this.role===h.default.ADMIN||"none"!==this.permissions.get(t)};t.prototype.canAdminSpace=function e(t){return this.role===h.default.ADMIN||this.permissions.get(t)===h.default.ADMIN};t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r instanceof t)return r;return new t(n({},r,{invite:r.invite||null}))};t.createForUser=function e(r){var n=r.user,o=r.role,i=void 0===o?h.default.READER:o,a=r.teams,u=void 0===a?(0,s.Map)():a;return t.createForUserID({userID:n.uid,role:i,teams:u})};t.createForUserID=function e(r){var n=r.userID,o=r.role,i=void 0===o?h.default.READER:o,a=r.teams,u=void 0===a?(0,s.Map)():a;return t.create({uid:n,role:i,teams:u,joinedAt:new Date})};t.createForInvite=function e(r,n){if(n.teamID){var o;return t.create({uid:r,joinedAt:new Date,invite:n.uid,teams:(0,s.Map)((o={},o[n.teamID]=p.default.create({role:n.role,joinedAt:new Date}),o))})}return t.create({uid:r,role:n.role,invite:n.uid,joinedAt:new Date})};t.deserialize=function e(r){return t.create(n({},r,{joinedAt:new Date(r.joinedAt),teams:(0,s.Map)(r.teams||{}).map(function(e){return p.default.deserialize(e)}),permissions:(0,s.Map)(r.permissions||{})}))};t.isRoleUpgrade=function e(t,r){var n=(0,a.default)(h.default);var o=n.findIndex(function(e){return e===r});var i=n.findIndex(function(e){return e===t});return o>i};t.prototype.serialize=function e(){return{uid:this.uid,role:this.role,invite:this.invite,joinedAt:this.joinedAt.getTime(),teams:this.teams.map(function(e){return e.serialize()}).toJS(),permissions:this.permissions.toJS()}};t.prototype.updateFromTeamInvite=function e(t){return this.merge({teams:this.teams.set(t.teamID,p.default.create({role:t.role,joinedAt:new Date})),invite:t.uid})};t.prototype.toTeamUpdate=function e(t){var r;var n=t.orgID,o=t.team;return(new u.DatabaseUpdate).update(this.query(n),{teams:this.teams.merge((r={},r[o.uid]=p.default.create({role:this.role}),r)).toJS()})};t.prototype.toUpdate=function e(r){var n=new u.DatabaseUpdate;var o=new l.default({uid:r,role:this.role,joinedAt:this.joinedAt});return n.set(t.queryByID({orgID:r,userID:this.uid}),this).set(l.default.queryByID({orgID:r,userID:this.uid}),o)};t.prototype.toDeleteUpdate=function e(r){return(new u.DatabaseUpdate).delete(t.queryByID({orgID:r,userID:this.uid})).delete(l.default.queryByID({orgID:r,userID:this.uid}))};o(t,[{key:"key",get:function e(){return this.uid}},{key:"canEdit",get:function e(){return/^(writer|reviewer|admin)$/.test(this.role)}},{key:"canReview",get:function e(){return/^(reviewer|admin)$/.test(this.role)}},{key:"canAdmin",get:function e(){return this.role==h.default.ADMIN}}]);return t}((0,u.DatabaseModel)("member",{uid:"",role:h.default.READER,joinedAt:new Date,invite:null,teams:(0,s.Map)(),permissions:(0,s.Map)()}));t.default=g},"./core/models/MigrationBook.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./node_modules/immutable/dist/immutable.js");function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function u(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=function(e){u(t,e);function t(){a(this,t);return s(this,e.apply(this,arguments))}t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r instanceof t)return r;return new t(n({},r,{repoID:r.repoID||null,customDomain:r.customDomain||null,completedAt:new Date(r.completedAt||new Date)}))};t.deserialize=function e(r){return t.create(r)};t.prototype.serialize=function e(){return{bookID:this.bookID,spaceID:this.spaceID,branches:this.branches,message:this.message,repoID:this.repoID,customDomain:this.customDomain,status:this.status,completedAt:this.completedAt.getTime()}};t.prototype.importDefaultBranch=function e(){return this.merge({status:"pending",branches:"default"})};t.prototype.importAllBranches=function e(){return this.merge({status:"pending",branches:"all"})};o(t,[{key:"shouldImportAllBranches",get:function e(){return"all"===this.branches}}]);return t}((0,i.Record)({bookID:"",spaceID:"",message:"",status:"pending",branches:"default",repoID:null,customDomain:null,completedAt:new Date}));t.default=c},"./core/models/MigrationStatus.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./node_modules/immutable/dist/immutable.js");var a=r("./core/models/database/index.js");var s=r("./core/models/MigrationBook.js");var u=c(s);function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function p(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var d=function(e){p(t,e);function t(){l(this,t);return f(this,e.apply(this,arguments))}t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r instanceof t)return r;return new t(n({},r,{books:(0,i.Map)(r.books||{}).map(function(e){return u.default.deserialize(e)}),createdAt:new Date(r.createdAt||new Date),updatedAt:new Date(r.updatedAt||new Date)}))};t.queryByOrgID=function e(t){return this.query("migration/beta").doc(t)};t.queryByLegacyOrgID=function e(t){return this.query("migration/legacy").doc(t)};t.prototype.queryByOrgID=function e(){return t.queryByOrgID(this.orgID)};t.prototype.queryByLegacyOrgID=function e(){return t.queryByLegacyOrgID(this.legacyOrgID)};t.prototype.toSyncUpdate=function e(){var t=new a.DatabaseUpdate;t.set(this.queryByOrgID(),this).set(this.queryByLegacyOrgID(),this);return t};t.prototype.toDeleteUpdate=function e(){var t=new a.DatabaseUpdate;t.delete(this.queryByOrgID()).delete(this.queryByLegacyOrgID());return t};t.prototype.toBookUpdate=function e(t){var r=new a.DatabaseUpdate;r.updateProperty(this.queryByOrgID(),"books/"+t.bookID,t.serialize()).updateProperty(this.queryByLegacyOrgID(),"books/"+t.bookID,t.serialize());return r};t.prototype.getBookBySpaceID=function e(t){return this.books.find(function(e){return e.spaceID===t})||null};t.prototype.updateBook=function e(){var t;var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var n=this.books;var o=r instanceof u.default?r:u.default.create(r);return this.merge({books:n.merge((t={},t[o.bookID]=o,t))})};t.deserialize=function e(r){return t.create(r)};t.prototype.serialize=function e(){return{orgID:this.orgID,legacyOrgID:this.legacyOrgID,books:this.books.map(function(e){return e.serialize()}).toObject(),confirmed:this.confirmed,githubSync:this.githubSync,createdAt:this.createdAt.getTime(),updatedAt:this.updatedAt.getTime()}};o(t,[{key:"githubBooks",get:function e(){return this.books.filter(function(e){return!!e.repoID}).toList()}},{key:"readyAt",get:function e(){var t=864e5;return new Date(this.createdAt.getTime()+t)}},{key:"isReady",get:function e(){return this.readyAt.getTime()<Date.now()}}]);return t}((0,a.DatabaseModel)("migrationStatus",{orgID:"",legacyOrgID:"",books:(0,i.Map)(),createdAt:new Date,updatedAt:new Date,confirmed:false,githubSync:false}));t.default=d},"./core/models/OrgBaseDomain.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r("./core/models/database/index.js");function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(e){a(t,e);function t(){o(this,t);return i(this,e.apply(this,arguments))}t.queryByDomain=function e(t){return this.query("orgDomains").doc((0,n.escapeKey)(t))};t.prototype.query=function e(){return t.queryByDomain(this.domain)};t.createFromOrg=function e(r){return new t({orgID:r.uid,domain:r.baseDomain})};t.deserialize=function e(r){return new t({orgID:r.orgID,domain:r.domain})};t.prototype.serialize=function e(){return{orgID:this.orgID,domain:this.domain}};return t}((0,n.DatabaseModel)("orgBaseDomain",{orgID:"",domain:""}));t.default=s},"./core/models/OrgSearchResult.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./node_modules/immutable/dist/immutable.js");function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function u(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=function(e){u(t,e);function t(){a(this,t);return s(this,e.apply(this,arguments))}t.createFromOrg=function e(r){return new t({objectID:r.uid,name:r.name,createdAt:r.createdAt,createdBy:r.createdBy,baseDomain:r.baseDomain,customDomain:r.customDomain,type:r.type})};t.deserialize=function e(r){return new t(n({},r,{createdAt:new Date(r.createdAt)}))};t.prototype.serialize=function e(){return{objectID:this.objectID,name:this.name,createdAt:this.createdAt.getTime(),createdBy:this.createdBy,baseDomain:this.baseDomain,customDomain:this.customDomain,type:this.type}};o(t,[{key:"index",get:function e(){return t.INDEX}}],[{key:"INDEX",get:function e(){return"organizations"}}]);return t}((0,i.Record)({objectID:"",name:"",createdAt:new Date,createdBy:"",baseDomain:"",customDomain:null,type:null}));t.default=c},"./core/models/OrgSpace.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r("./core/models/database/index.js");function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(e){a(t,e);function t(){o(this,t);return i(this,e.apply(this,arguments))}t.queryByOrg=function e(t){return this.query(["orgs",t,"spaces"])};t.queryByName=function e(t){var r=t.orgID,o=t.baseName;return this.queryByOrg(r).doc((0,n.escapeKey)(o))};t.prototype.query=function e(r){return t.queryByName({orgID:r,baseName:this.baseName})};t.createFromSpace=function e(r){return new t({spaceID:r.uid,baseName:r.baseName})};t.deserialize=function e(r){return new t(r)};t.prototype.serialize=function e(){return{spaceID:this.spaceID,baseName:this.baseName}};return t}((0,n.DatabaseModel)("orgSpace",{spaceID:"",baseName:""}));t.default=s},"./core/models/OrgUsage.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./core/models/database/index.js");var a=r("./core/constants/BILLING.js");function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function c(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(e){c(t,e);function t(){s(this,t);return u(this,e.apply(this,arguments))}t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(n({},r,{updatedAt:new Date(r.updatedAt||new Date)}))};t.queryByID=function e(t){return this.query("orgUsage").doc(t)};t.prototype.query=function e(){return t.queryByID(this.orgID)};t.deserialize=function e(r){return t.create(r)};t.prototype.serialize=function e(){return{orgID:this.orgID,membersCount:this.membersCount,privateSpacesCount:this.privateSpacesCount,spacesCount:this.spacesCount,activePlan:this.activePlan,updatedAt:this.updatedAt.getTime()}};o(t,[{key:"publicSpaces",get:function e(){return this.spacesCount-this.privateSpacesCount}},{key:"isOverLimits",get:function e(){return"free"===this.activePlan&&(this.membersCount>a.BILLING_SPEC.free.members||this.privateSpacesCount>a.BILLING_SPEC.free.privateSpaces||this.spacesCount-this.privateSpacesCount>a.BILLING_SPEC.free.privateSpaces)}}]);return t}((0,i.DatabaseModel)("orgUsage",{orgID:"",membersCount:0,privateSpacesCount:0,spacesCount:0,activePlan:"free",updatedAt:new Date}));t.default=l},"./core/models/Organization.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./node_modules/immutable/dist/immutable.js");var a=r("./core/models/database/index.js");var s=r("./core/constants/ROLES.js");var u=b(s);var c=r("./core/models/Membership.js");var l=b(c);var f=r("./core/models/Invite.js");var p=b(f);var d=r("./core/models/OrgBaseDomain.js");var h=b(d);var y=r("./core/models/CustomDomain.js");var m=b(y);function b(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function D(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var w=function(e){D(t,e);function t(){v(this,t);return g(this,e.apply(this,arguments))}t.queryByID=function e(t){return this.query("orgs").doc(t+"/infos")};t.prototype.query=function e(){return t.queryByID(this.uid)};t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r instanceof t)return r;return new t(n({},r,{uid:r.uid||(0,a.genKey)(),createdAt:new Date(r.createdAt||Date.now()),baseDomain:t.normalizeBaseDomain(r.baseDomain||""),customDomain:r.customDomain||null}))};t.prototype.regenerateUID=function e(){return this.merge({uid:(0,a.genKey)()})};t.deserialize=function e(r){return new t(n({},r,{spacesPermission:(0,i.Map)(r.spacesPermission),createdAt:new Date(r.createdAt)}))};t.prototype.serialize=function e(){return{uid:this.uid,name:this.name,createdAt:this.createdAt.getTime(),createdBy:this.createdBy,logoURL:this.logoURL,baseDomain:this.baseDomain,type:this.type,spacesPermission:this.spacesPermission.toJS(),customDomain:this.customDomain,ssoSignInLabel:this.ssoSignInLabel,defaultSpace:this.defaultSpace,lockReason:this.lockReason}};t.getDefaultSpaceFallback=function e(t){var r=t.last();return r?r.spaceID:null};t.prototype.isOwner=function e(t){return this.createdBy===t};t.prototype.canSuperAdmin=function e(t){return t.isSiteAdmin||this.isOwner(t.uid)};t.prototype.getURL=function e(t){return t?"https://"+this.baseDomain+"."+t:"/spaces/"+this.baseDomain};t.prototype.getSpacesURL=function e(t){if(this.customDomain)return"https://"+this.customDomain;return this.getURL(t)};t.prototype.toCreateUpdate=function e(){var t=new a.DatabaseUpdate;var r=l.default.createForUserID({userID:this.createdBy,joinedAt:this.createdAt,role:u.default.ADMIN});var n=h.default.createFromOrg(this);var o=m.default.createFromOrg(this);t.set(this.query(),this).set(h.default.queryByDomain(n.domain),n).merge(r.toUpdate(this.uid),p.default.getNewInvitesUpdate(this.uid));o&&t.set(m.default.queryByDomain(o.domain),o);return t};t.prototype.toCustomDomainUpdate=function e(t){var r=new a.DatabaseUpdate;var n=this.merge({customDomain:t});var o=m.default.createFromOrg(n);var i=m.default.createFromOrg(this);r.update(this.query(),{customDomain:o?t:null});i&&this.customDomain&&this.customDomain!==t&&r.set(m.default.queryByDomain(this.customDomain),i.merge({deprecated:true}));o&&t&&r.set(m.default.queryByDomain(t),o);return r};t.prototype.toBaseDomainUpdate=function e(t){var r=new a.DatabaseUpdate;var n=this.merge({baseDomain:t});var o=h.default.createFromOrg(n);r.update(this.query(),{baseDomain:t});r.set(h.default.queryByDomain(t),o);return r};t.prototype.toTransferOwnershipUpdate=function e(t){return(new a.DatabaseUpdate).update(this.query(),{createdBy:t})};t.prototype.toLockReasonUpdate=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(new a.DatabaseUpdate).update(this.query(),{lockReason:t})};t.prototype.toTypeUpdate=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(new a.DatabaseUpdate).update(this.query(),{type:t})};t.prototype.toDeleteUpdate=function e(){var t=new a.DatabaseUpdate;t.delete(this.query());return t};t.prototype.setBaseDomain=function e(r){return this.merge({baseDomain:t.normalizeBaseDomain(r)})};t.prototype.setCustomDomain=function e(t){return this.merge({customDomain:t||null})};t.normalizeBaseDomain=function e(t){return t.trim().replace(/[^a-zA-Z0-9-]/g,"-").replace(/-+/g,"-").toLowerCase().substr(0,32).replace(/-$/,"")};t.validateBaseDomain=function e(t){return Boolean(/^[a-z0-9-_]+$/.test(t)&&t.length>=3&&t.length<=32&&"www"!=t)};t.validateCustomDomain=function e(t){return!t||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/.test(t)};o(t,[{key:"isLocked",get:function e(){return null!==this.lockReason}}]);return t}((0,a.DatabaseModel)("org",{uid:"",name:"",createdAt:new Date,createdBy:"",logoURL:null,type:null,baseDomain:"",spacesPermission:(0,i.Map)(),customDomain:null,ssoSignInLabel:null,defaultSpace:null,lockReason:null}));t.default=w},"./core/models/PageRating.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var o=r("./node_modules/immutable/dist/immutable.js");var i=r("./core/models/database/index.js");function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function u(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=function(e){u(t,e);function t(){a(this,t);return s(this,e.apply(this,arguments))}t.queryBySpace=function e(t){return this.query(["spaces",t,"pageRatings"])};t.queryByID=function e(t){var r=t.spaceID,n=t.pageID;return this.queryBySpace(r).doc(n)};t.getReadingScore=function e(t,r){var n=t/r*100;if(n>80)return 5;if(n>=60)return 4;if(n>=40)return 3;if(n>=20)return 2;return 1};t.getHealthScore=function e(t,r){if(!t)return r;if(!r)return t;return.6*t+.4*r};t.deserialize=function e(r){return new t({ratings:(0,o.List)(r.ratings),updatedAt:new Date(r.updatedAt)})};t.prototype.serialize=function e(){var t=this.ratings,r=this.updatedAt;return{ratings:t.toArray(),updatedAt:r.getTime()}};n(t,[{key:"ratersCount",get:function e(){return this.ratings.reduce(function(e,t){return e+t},0)}},{key:"averageScore",get:function e(){var t=this.ratersCount;if(!t)return null;var r=this.ratings.reduce(function(e,t,r){return e+(r+1)*t},0);return r/t}},{key:"sentimentScore",get:function e(){var t=this.ratings.get(4);var r=this.ratings.get(0)+this.ratings.get(1);var n=this.ratersCount;return n>0?(t-r)/n:null}}]);return t}((0,i.DatabaseModel)("pageRating",{ratings:(0,o.List)([0,0,0,0,0]),updatedAt:new Date}));t.default=c},"./core/models/PageRedirect.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=r("./core/models/database/index.js");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(e){s(t,e);function t(){i(this,t);return a(this,e.apply(this,arguments))}t.queryByVersion=function e(t){var r=t.spaceID,n=t.versionID;return this.query(["spaces",r,"redirects",(0,o.escapeKey)(n)])};t.queryByURL=function e(t){var r=t.spaceID,n=t.versionID,i=t.url;return this.queryByVersion({spaceID:r,versionID:n}).doc((0,o.escapeKey)(i))};t.prototype.query=function e(r){var n=r.spaceID,o=r.versionID;return t.queryByURL({spaceID:n,versionID:o,url:this.url})};t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r instanceof t)return r;return new t(n({},r,{createdAt:new Date(r.createdAt||Date.now())}))};t.deserialize=function e(r){return t.create(r)};t.prototype.serialize=function e(){return{url:this.url,pageID:this.pageID,createdAt:this.createdAt.getTime()}};return t}((0,o.DatabaseModel)("pageRedirect",{url:"",pageID:"",createdAt:new Date}));t.default=u},"./core/models/PageSearchResult.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./node_modules/immutable/dist/immutable.js");function a(e,t){var r={};for(var n in e){if(t.indexOf(n)>=0)continue;if(!Object.prototype.hasOwnProperty.call(e,n))continue;r[n]=e[n]}return r}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function c(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(e){c(t,e);function t(){s(this,t);return u(this,e.apply(this,arguments))}t.createFromPage=function e(r,n,o){return new t({pageID:r.uid,title:r.title,description:r.description,spaceID:n,versionID:o})};t.getVersionFilter=function e(t){return"version/"+t};t.getPageFilter=function e(t){return"page/"+t};t.deserialize=function e(r){var o=r.objectID,i=r._highlightResult,s=r._rankingInfo,u=a(r,["objectID","_highlightResult","_rankingInfo"]);var c=o.split("/"),l=c[0],f=c[1],p=c[2];var d=n({pageID:p,versionID:f,spaceID:l},u);if(i){d.highlightedTitle=i.title.value;d.highlightedDescription=i.description.value}s&&(d.searchScore=s.userScore);return new t(d)};t.prototype.serialize=function e(){var t=this.objectID,r=this.title,n=this.description;return{objectID:t,title:r,description:n}};o(t,[{key:"objectID",get:function e(){var t=this.spaceID,r=this.versionID,n=this.pageID;return t+"/"+r+"/"+n}},{key:"indexTags",get:function e(){var r=this.spaceID,n=this.versionID;return[r,t.getVersionFilter(n)]}},{key:"sectionsFilters",get:function e(){var r=this.pageID;var n=t.getPageFilter(r);return this.indexTags.join(" AND ")+" AND "+n}},{key:"index",get:function e(){return t.INDEX}}],[{key:"INDEX",get:function e(){return"pages"}}]);return t}((0,i.Record)({pageID:"",spaceID:"",versionID:"",title:"",description:"",highlightedTitle:"",highlightedDescription:"",searchScore:0}));t.default=l},"./core/models/Revision.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./node_modules/immutable/dist/immutable.js");var a=r("./node_modules/immutablejs-record-memoize/dist/index.js");var s=v(a);var u=r("./core/models/database/index.js");var c=r("./core/models/Version.js");var l=v(c);var f=r("./core/models/Draft.js");var p=v(f);var d=r("./core/models/Asset.js");var h=v(d);var y=r("./core/diffing/index.js");var m=r("./core/models/GitHubCommitState.js");var b=v(m);function v(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function w(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var j=function(e){w(t,e);function t(){g(this,t);return D(this,e.apply(this,arguments))}t.queryByID=function e(t){var r=t.spaceID,n=t.revisionID;return this.query(["spaces",r,"revisions"]).doc(n)};t.prototype.query=function e(r){return t.queryByID({spaceID:r,revisionID:this.uid})};t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r instanceof t)return r;var o=r.versions||l.default.createInitialVersions();return new t(n({},r,{versions:o,assets:r.assets?r.assets:(0,i.Map)(),primaryVersionID:r.primaryVersionID||o.first().uid,parents:(0,i.List)(r.parents||[]),uid:r.uid||(0,u.genKey)(),github:(0,i.List)(r.github?r.github.map(function(e){return b.default.create(e)}):[])}))};t.deserialize=function e(r){var n=r.github||[];var o=Array.isArray(n)?n:[n];return t.create({uid:r.uid,message:r.message,createdAt:new Date(r.createdAt),createdBy:r.createdBy,parents:r.parent?[r.parent]:r.parents,primaryVersionID:r.content.primaryVersion,versions:l.default.deserializeVersions(r.content.versions),assets:(0,i.Map)(r.content.assets||{}).map(function(e){return h.default.deserialize(e)}),github:o.map(function(e){return b.default.deserialize(e)}),rollbackOf:r.rollbackOf?r.rollbackOf:null})};t.prototype.serialize=function e(){return{uid:this.uid,message:this.message,createdAt:this.createdAt.getTime(),createdBy:this.createdBy,parents:this.parents.toArray(),content:{primaryVersion:this.primaryVersionID,versions:l.default.serializeVersions(this.versions),assets:this.assets.map(function(e){return e.serialize()}).toObject()},github:this.github.map(function(e){return e.serialize()}).toArray(),rollbackOf:this.rollbackOf?this.rollbackOf:null}};t.createInitialRevision=function e(r){return t.create({message:"Initial revision",createdBy:r.uid,versions:l.default.createInitialVersions()})};t.prototype.setParents=function e(t){return this.merge({parents:(0,i.List)(t)})};t.prototype.setMainParent=function e(r){var n=r instanceof t?r.uid:r;return this.merge({parents:this.parents.filter(function(e){return e!=n}).unshift(n)})};t.prototype.hasParent=function e(r){var n=r instanceof t?r.uid:r;return this.parents.some(function(e){return e==n})};t.prototype.fork=function e(){return this.merge({uid:(0,u.genKey)(),parents:[this.uid],message:"",github:(0,i.List)(),rollbackOf:null,createdAt:new Date})};t.prototype.rollback=function e(t){return this.merge({uid:(0,u.genKey)(),parents:[t],rollbackOf:this.rollbackOf||this.uid})};t.prototype.authorizeAs=function e(t){return this.merge({createdBy:t.uid,createdAt:new Date})};t.prototype.toCommitUpdate=function e(t){var r=t.space,n=t.draft;var o=this.toCreateUpdate(r.uid);n?o.merge(n.merge({revisionCurrent:this.uid}).markAsModified().toUpdate(r.uid)):o.merge(r.toCheckoutUpdate(this));return o};t.prototype.toUpdate=function e(t){return(new u.DatabaseUpdate).update(this.query(t),{message:this.message})};t.prototype.toCreateUpdate=function e(t){return(new u.DatabaseUpdate).set(this.query(t),this)};t.prototype.toRollbackUpdate=function e(t){var r=t.user,n=t.space,o=t.draft;var i=this.authorizeAs(r).rollback(o?o.revisionCurrent:n.primaryRevision);return i.toCommitUpdate({space:n,draft:o})};t.prototype.diffVersions=function e(t){return(0,y.diffVersions)(t.versions,this.versions)};t.prototype.diffPages=function e(t,r){return(0,y.diffPages)(t,r)};t.prototype.diffDocuments=function e(t,r){var n=(0,y.diffNodes)(t.nodes,r.nodes);return(0,y.toDiffEditorState)(n)};o(t,[{key:"parent",get:function e(){return this.parents.first()}},{key:"defaultMessage",get:function e(){return this.message||(this.isSyncedWithGitHub?this.github.first().message:"")}},{key:"primaryVersion",get:function e(){var t=this.versions.get(this.primaryVersionID);if(!t)throw new Error('Version "'+this.primaryVersionID+'" not found in the revision');return t}},{key:"isSyncedWithGitHub",get:function e(){return this.github.size>0}},{key:"isRollback",get:function e(){return Boolean(this.rollbackOf)}},{key:"isMerge",get:function e(){return this.parents.size>1}}]);return t}((0,u.DatabaseModel)("revision",{uid:"",message:"",createdAt:new Date,createdBy:"",parents:(0,i.List)(),versions:(0,i.OrderedMap)(),primaryVersionID:"",assets:(0,i.Map)(),github:(0,i.List)(),rollbackOf:null}));(0,s.default)(j.prototype,["diffVersions","diffPages","diffDocuments"],{takesArguments:true});t.default=j},"./core/models/SAMLIdP.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=r("./core/models/database/index.js");var i=r("./core/models/Organization.js");var a=s(i);function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f=function(e){l(t,e);function t(){u(this,t);return c(this,e.apply(this,arguments))}t.queryByOrg=function e(t){return this.query(["orgs",t]).doc("saml")};t.prototype.query=function e(r){return t.queryByOrg(r)};t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r instanceof t)return r;return new t(n({},r,{createdAt:new Date(r.createdAt||Date.now())}))};t.deserialize=function e(r){return t.create(r)};t.prototype.serialize=function e(){return{label:this.label,ssoURL:this.ssoURL,entityID:this.entityID,certificate:this.certificate,createdAt:this.createdAt.getTime()}};t.prototype.toUpdate=function e(t){return(new o.DatabaseUpdate).set(this.query(t),this).update(a.default.queryByID(t),{ssoSignInLabel:this.label})};t.prototype.toRemoveUpdate=function e(t){return(new o.DatabaseUpdate).delete(this.query(t)).update(a.default.queryByID(t),{ssoSignInLabel:null})};return t}((0,o.DatabaseModel)("samlIdP",{label:"",ssoURL:"",entityID:"",certificate:"",createdAt:new Date}));t.default=f},"./core/models/SectionSearchResult.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i,a;var s=r("./node_modules/immutable/dist/immutable.js");var u=r("./core/edition/Section.js");var c=l(u);function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t){var r={};for(var n in e){if(t.indexOf(n)>=0)continue;if(!Object.prototype.hasOwnProperty.call(e,n))continue;r[n]=e[n]}return r}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var y=(a=i=function(e){h(t,e);function t(){p(this,t);return d(this,e.apply(this,arguments))}t.createFromPageAndSection=function e(r,n){var o=r.pageID,i=r.spaceID,a=r.versionID;var s=n.title,u=n.id,c=n.key;return new t({pageID:o,spaceID:i,versionID:a,title:s,sectionID:c,content:n.text,hash:u})};t.getVersionFilter=function e(t){return"version/"+t};t.getPageFilter=function e(t){return"page/"+t};t.deserialize=function e(r){var o=r.objectID,i=r._highlightResult,a=r._rankingInfo,s=f(r,["objectID","_highlightResult","_rankingInfo"]);var u=o.split("/"),c=u[0],l=u[1],p=u[2],d=u[3];var h=n({spaceID:c,versionID:l,pageID:p,sectionID:d},s);if(i){h.highlightedTitle=i.title.value;h.highlightedContent=i.content.value}a&&(h.searchScore=a.userScore);return new t(h)};t.prototype.serialize=function e(){var r=this.objectID,n=this.title,o=this.content,i=this.hash;return{objectID:r,title:n,content:o.slice(0,t.CONTENT_SIZE_LIMIT),hash:i}};o(t,[{key:"objectID",get:function e(){var t=this.spaceID,r=this.versionID,n=this.pageID,o=this.sectionID;return t+"/"+r+"/"+n+"/"+o}},{key:"indexTags",get:function e(){var r=this.spaceID,n=this.versionID,o=this.pageID;return[r,t.getVersionFilter(n),t.getPageFilter(o)]}},{key:"index",get:function e(){return t.INDEX}}],[{key:"INDEX",get:function e(){return"sections"}}]);return t}((0,s.Record)({pageID:"",spaceID:"",versionID:"",sectionID:"",title:"",content:"",hash:"",highlightedTitle:"",highlightedContent:"",searchScore:0})),i.CONTENT_SIZE_LIMIT=8e3,a);t.default=y},"./core/models/SlackChannel.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=r("./node_modules/immutable/dist/immutable.js");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(e){s(t,e);function t(){i(this,t);return a(this,e.apply(this,arguments))}t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.deserialize(n({},r,{createdAt:r.createdAt||Date.now()}))};t.deserialize=function e(r){return new t(n({},r,{createdAt:new Date(r.createdAt)}))};t.prototype.serialize=function e(){return{token:this.token,channelName:this.channelName,channelID:this.channelID,webhookURL:this.webhookURL,createdAt:this.createdAt.getTime()}};return t}((0,o.Record)({token:"",channelName:"",channelID:"",webhookURL:"",createdAt:new Date}));t.default=u},"./core/models/SlackIntegration.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=r("./node_modules/immutable/dist/immutable.js");var i=r("./core/models/database/index.js");var a=r("./core/models/SlackChannel.js");var s=u(a);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function f(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(e){f(t,e);function t(){c(this,t);return l(this,e.apply(this,arguments))}t.queryBySpace=function e(t){return this.query(["spaces",t,"slack"])};t.queryByTeam=function e(t){var r=t.spaceID,n=t.teamID;return this.queryBySpace(r).doc(n)};t.queryByRootTeam=function e(t){return this.query(["slack",t])};t.prototype.query=function e(){return t.queryByTeam({spaceID:this.spaceID,teamID:this.teamID})};t.prototype.rootQuery=function e(){return t.queryByRootTeam(this.teamID).doc(this.spaceID)};t.prototype.toCreateUpdate=function e(){return(new i.DatabaseUpdate).set(this.query(),this).set(this.rootQuery(),this)};t.prototype.toRemoveUpdate=function e(){return(new i.DatabaseUpdate).delete(this.query()).delete(t.query(["slack",this.teamID]).doc(this.spaceID))};t.prototype.removeChannel=function e(t){return this.merge({channels:this.channels.delete(t.channelID)})};t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(n({},r,{channels:(0,o.OrderedMap)(r.channels||{}).map(function(e){return s.default.create(e)}),createdAt:new Date(r.createdAt||Date.now())}))};t.deserialize=function e(r){return new t(n({},r,{channels:(0,o.OrderedMap)(r.channels||{}).map(function(e){return s.default.deserialize(e)}),createdAt:new Date(r.createdAt)}))};t.prototype.serialize=function e(){return{spaceID:this.spaceID,token:this.token,teamID:this.teamID,teamName:this.teamName,channels:this.channels.map(function(e){return e.serialize()}).toObject(),createdAt:this.createdAt.getTime()}};return t}((0,i.DatabaseModel)("slackIntegration",{spaceID:"",token:"",teamID:"",teamName:"",channels:(0,o.OrderedMap)(),createdAt:new Date}));t.default=p},"./core/models/Space.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i,a;var s=r("./node_modules/immutable/dist/immutable.js");var u=r("./core/models/database/index.js");var c=r("./core/models/SpaceLink.js");var l=b(c);var f=r("./core/models/OrgSpace.js");var p=b(f);var d=r("./core/models/Revision.js");var h=b(d);var y=r("./core/models/CustomDomain.js");var m=b(y);function b(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function D(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var w=(a=i=function(e){D(t,e);function t(){v(this,t);return g(this,e.apply(this,arguments))}t.queryByID=function e(t){return this.query("spaces/"+t).doc("infos")};t.prototype.query=function e(){return t.queryByID(this.uid)};t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r instanceof t)return r;return new t(n({},r,{uid:r.uid||(0,u.genKey)(),colorPrimary:r.colorPrimary||"#f47c24",intercomID:r.intercomID?r.intercomID:null,googleAnalyticsID:r.googleAnalyticsID?r.googleAnalyticsID:null}))};t.prototype.regenerateUID=function e(){return this.merge({uid:(0,u.genKey)()})};t.prototype.setVisibility=function e(t){switch(t){case"private":return this.merge({isPrivate:true,isUnlisted:false});default:return this.merge({isPrivate:false,isUnlisted:false})}};t.prototype.getURL=function e(t,r){var n=this.customDomain?"https://"+this.customDomain+"/":t.getSpacesURL(r)+"/"+this.baseName+"/";if(this.isPrivate&&this.secretToken)return""+n+this.secretToken+"/";return n};t.prototype.limitLinks=function e(){return this.merge({links:this.links.take(t.LINKS_LIMIT)})};t.prototype.moveLink=function e(t,r){var n=this.links;var o=n.get(t);var i=n.splice(t,1).splice(r,0,o);return this.merge({links:i})};t.prototype.toLinksUpdate=function e(){var r=this.links;return(new u.DatabaseUpdate).update(t.queryByID(this.uid),{links:r.map(function(e){return e.serialize()}).toArray()})};t.prototype.toSecretTokenUpdate=function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(new u.DatabaseUpdate).update(this.query(),{secretToken:t?null:(0,u.genKey)()})};t.prototype.toCustomDomainUpdate=function e(r){var n=this.merge({customDomain:r});var o=m.default.createFromSpace(n);var i=m.default.createFromSpace(this);var a=new u.DatabaseUpdate;a.update(t.queryByID(this.uid),{customDomain:o?r:null});i&&this.customDomain&&this.customDomain!==r&&a.set(m.default.queryByDomain(this.customDomain),i.merge({deprecated:true}));o&&a.set(m.default.queryByDomain(o.domain),o);return a};t.prototype.toBaseNameUpdate=function e(r){var n=p.default.createFromSpace(this.merge({baseName:r}));return(new u.DatabaseUpdate).set(n.query(this.orgID),n).delete(p.default.queryByName({orgID:this.orgID,baseName:this.baseName})).update(t.queryByID(this.uid),{baseName:r})};t.prototype.toCreateUpdate=function e(){var r=p.default.createFromSpace(this);var n=m.default.createFromSpace(this);var o=(new u.DatabaseUpdate).set(t.queryByID(this.uid),this).set(p.default.queryByName({orgID:this.orgID,baseName:this.baseName}),r);n&&o.set(m.default.queryByDomain(n.domain),n);return o};t.prototype.toDeleteUpdate=function e(){var r=new u.DatabaseUpdate;r.deleteCollection(t.query("spaces/"+this.uid));r.delete(p.default.queryByName({orgID:this.orgID,baseName:this.baseName}));this.customDomain&&r.delete(m.default.queryByDomain(this.customDomain));return r};t.prototype.toCheckoutUpdate=function e(r){return(new u.DatabaseUpdate).update(t.queryByID(this.uid),{primaryRevision:r.uid,updatedAt:r.createdAt.getTime()})};t.prototype.toVisibilityUpdate=function e(){return(new u.DatabaseUpdate).update(t.queryByID(this.uid),{isPrivate:this.isPrivate,isUnlisted:this.isUnlisted,secretToken:this.isPrivate?this.secretToken:null})};t.deserialize=function e(r){return new t(n({},r,{secretToken:r.secretToken||null,isUnlisted:Boolean(r.isUnlisted),createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt||r.createdAt),links:(0,s.List)((r.links||[]).map(function(e){return l.default.deserialize(e)}))}))};t.prototype.serialize=function e(){return{uid:this.uid,name:this.name,orgID:this.orgID,isPrivate:this.isPrivate,isUnlisted:this.isUnlisted,secretToken:this.secretToken,logoURL:this.logoURL,primaryRevision:this.primaryRevision,colorPrimary:this.colorPrimary,createdAt:this.createdAt.getTime(),updatedAt:this.updatedAt.getTime(),createdBy:this.createdBy,algoliaAPIKey:this.algoliaAPIKey,baseName:this.baseName,customDomain:this.customDomain,links:this.links.map(function(e){return e.serialize()}).toArray(),hasGitHubSync:this.hasGitHubSync,editOnGitHub:this.editOnGitHub,googleAnalyticsID:this.googleAnalyticsID,intercomID:this.intercomID}};t.prototype.setBaseName=function e(r){return this.merge({baseName:t.normalizeBaseName(r)})};t.normalizeBaseName=function e(t){return t.trim().replace(/[^a-zA-Z0-9-]/g,"-").replace(/-+/g,"-").toLowerCase().substr(0,50).replace(/-$/,"")};t.validateBaseName=function e(t){return Boolean(/^[a-z0-9-_]+$/.test(t)&&t.length>=1&&t.length<=50)};t.validateColor=function e(t){return/^#([0-9a-f]{6}|[0-9a-f]{3})$/i.test(t)};o(t,[{key:"visibility",get:function e(){if(this.isPrivate)return"private";return"public"}},{key:"isIndexable",get:function e(){return!this.isPrivate&&!this.isUnlisted}}]);return t}((0,u.DatabaseModel)("space",{uid:"",name:"",baseName:"",orgID:"",isPrivate:false,isUnlisted:false,secretToken:null,createdAt:new Date,updatedAt:new Date,createdBy:"",logoURL:null,colorPrimary:"#3884FF",primaryRevision:"",algoliaAPIKey:"",customDomain:null,links:(0,s.List)(),hasGitHubSync:false,editOnGitHub:null,googleAnalyticsID:null,intercomID:null})),i.LINKS_LIMIT=4,a);t.default=w},"./core/models/SpaceLink.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./node_modules/immutable/dist/immutable.js");var a=r("./node_modules/is-url-superb/index.js");var s=l(a);var u=r("./node_modules/is-email/lib/index.js");var c=l(u);function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h=function(e){d(t,e);function t(){f(this,t);return p(this,e.apply(this,arguments))}t.prototype.updateTitle=function e(t){return this.merge({title:t})};t.prototype.updateHref=function e(t){return this.merge({href:t,pageID:null})};t.prototype.updatePageID=function e(t){return this.merge({pageID:t,href:null})};t.deserialize=function e(r){return new t(n({},r))};t.prototype.serialize=function e(){var t=this.title,r=this.href,n=this.pageID;return{title:t,href:r,pageID:n}};o(t,[{key:"isValid",get:function e(){return Boolean(this.title&&(this.isValidHref||this.pageID))}},{key:"isValidHref",get:function e(){var t=this.href;if(!t||t.length>=512)return false;return/^https?:\/\//.test(t)&&(0,s.default)(t)||/^mailto:/.test(t)&&(0,c.default)(t.replace("mailto:",""))}}]);return t}((0,i.Record)({title:"",href:null,pageID:null}));t.default=h},"./core/models/Team.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=r("./node_modules/immutable/dist/immutable.js");var i=r("./core/models/database/index.js");var a=r("./core/models/Invite.js");var s=u(a);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function f(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(e){f(t,e);function t(){c(this,t);return l(this,e.apply(this,arguments))}t.queryByID=function e(t){var r=t.orgID,n=t.teamID;return this.query(["orgs",r,"teams"]).doc(n)};t.queryByOrg=function e(t){return this.query(["orgs",t,"teams"])};t.queryCoreTeam=function e(t){return this.query(["orgs",t,"teams"]).doc("core")};t.prototype.query=function e(r){return t.queryByID({orgID:r,teamID:this.uid})};t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r instanceof t)return r;return new t(n({},r,{uid:r.uid||(0,i.genKey)()}))};t.createCoreTeam=function e(){return t.create({uid:"core",name:"Core team"})};t.prototype.toCreateUpdate=function e(t){var r=new i.DatabaseUpdate;r.set(this.query(t),this).merge(s.default.getNewInvitesUpdate(t,this.uid));return r};t.deserialize=function e(r){return new t(n({},r,{spacesPermission:(0,o.Map)(r.spacesPermission),createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)}))};t.prototype.serialize=function e(){var t=this.uid,r=this.name,n=this.spacesPermission,o=this.createdAt,i=this.updatedAt;return{uid:t,name:r,spacesPermission:n.toJS(),createdAt:o.getTime(),updatedAt:i.getTime()}};return t}((0,i.DatabaseModel)("team",{uid:"",name:"",createdAt:new Date,updatedAt:new Date,spacesPermission:(0,o.Map)()}));t.default=p},"./core/models/TeamMembership.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./node_modules/immutable/dist/immutable.js");var a=r("./core/constants/ROLES.js");var s=u(a);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function f(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(e){f(t,e);function t(){c(this,t);return l(this,e.apply(this,arguments))}t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(n({joinedAt:new Date},r))};t.deserialize=function e(r){return t.create(n({},r,{joinedAt:new Date(r.joinedAt)}))};t.prototype.serialize=function e(){return{role:this.role,joinedAt:this.joinedAt.getTime()}};o(t,[{key:"canEdit",get:function e(){return/^(writer|reviewer|admin)$/.test(this.role)}},{key:"canReview",get:function e(){return/^(reviewer|admin)$/.test(this.role)}},{key:"canAdmin",get:function e(){return this.role==s.default.ADMIN}}]);return t}((0,i.Record)({role:s.default.READER,joinedAt:new Date}));t.default=p},"./core/models/User.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i,a;var s=r("./core/models/database/index.js");function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f=(a=i=function(e){l(t,e);function t(){u(this,t);return c(this,e.apply(this,arguments))}t.queryByID=function e(t){return this.query("users").doc(t+"/infos")};t.prototype.query=function e(){return t.queryByID(this.uid)};t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r instanceof t)return r;return new t(n({},r,{uid:r.uid||(0,s.genKey)(),bio:r.bio?r.bio.substring(0,t.BIO_MAX_LENGTH):""}))};t.deserialize=function e(r){return t.create(n({},r,{lastLoggedInAt:new Date(r.lastLoggedInAt||Date.now()),deletedAt:r.deletedAt?new Date(r.deletedAt):null}))};t.prototype.updateBio=function e(r){return this.merge({bio:r.substring(0,t.BIO_MAX_LENGTH)})};t.prototype.asDeleted=function e(){return this.merge({bio:"",displayName:"Ghost",photoURL:null,deletedAt:new Date})};t.prototype.serialize=function e(){return{uid:this.uid,bio:this.bio,displayName:this.displayName,photoURL:this.photoURL||null,lastLoggedInAt:this.lastLoggedInAt.getTime(),deletedAt:this.deletedAt?this.deletedAt.getTime():null}};o(t,[{key:"firstName",get:function e(){return this.displayName.split(" ")[0]}},{key:"lastName",get:function e(){return this.displayName.split(" ").slice(1).join(" ")}},{key:"shortDisplayName",get:function e(){var t=this.firstName,r=this.lastName;if(!r)return t;return t+" "+r[0]+"."}}]);return t}((0,s.DatabaseModel)("user",{uid:"",displayName:"",bio:"",photoURL:null,lastLoggedInAt:new Date,deletedAt:null})),i.BIO_MAX_LENGTH=160,a);t.default=f},"./core/models/UserMembership.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./core/models/database/index.js");var a=r("./core/constants/ROLES.js");var s=u(a);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function f(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(e){f(t,e);function t(){c(this,t);return l(this,e.apply(this,arguments))}t.queryByUser=function e(t){return this.query(["users",t,"orgs"])};t.queryByID=function e(t){var r=t.orgID,n=t.userID;return this.queryByUser(n).doc(r)};t.prototype.query=function e(r){return t.queryByID({orgID:this.uid,userID:r})};t.deserialize=function e(r){return new t(n({},r,{joinedAt:new Date(r.joinedAt)}))};t.prototype.serialize=function e(){var t=this.uid,r=this.role,n=this.joinedAt;return{uid:t,role:r,joinedAt:n.getTime()}};o(t,[{key:"canEdit",get:function e(){return/^(writer|reviewer|admin)$/.test(this.role)}},{key:"canReview",get:function e(){return/^(reviewer|admin)$/.test(this.role)}},{key:"canAdmin",get:function e(){return this.role==s.default.ADMIN}}]);return t}((0,i.DatabaseModel)("userMembership",{uid:"",role:s.default.READER,joinedAt:new Date}));t.default=p},"./core/models/UserPageRating.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i=r("./types/Page.js");var a=r("./core/models/database/index.js");function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function c(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(e){c(t,e);function t(){s(this,t);return u(this,e.apply(this,arguments))}t.queryByID=function e(t){var r=t.spaceID,n=t.pageID,o=t.userID;return this.query(["spaces",r,"userPageRatings",n]).doc(o)};t.prototype.query=function e(r){var n=r.spaceID,o=r.pageID;return t.queryByID({spaceID:n,pageID:o,userID:this.userID})};t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r instanceof t)return r;return new t(n({},r,{createdAt:new Date(r.createdAt||Date.now())}))};t.deserialize=function e(r){return new t(n({},r,{createdAt:new Date(r.createdAt)}))};t.displayRatingToRating=function e(t){return{BAD:0,OK:2,GOOD:4}[t]};t.valueToDisplayRating=function e(t){return{0:"BAD",1:"BAD",2:"OK",3:"GOOD",4:"GOOD"}[t]};t.prototype.serialize=function e(){return{userID:this.userID,rating:this.rating,versionID:this.versionID,revisionID:this.revisionID,createdAt:this.createdAt.getTime()}};o(t,[{key:"createdBy",get:function e(){return this.userID}},{key:"displayRating",get:function e(){return t.valueToDisplayRating(this.rating)}}]);return t}((0,a.DatabaseModel)("userPageRating",{userID:"",rating:0,createdAt:new Date,versionID:"",revisionID:""}));t.default=l},"./core/models/UserSearchResult.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var o=r("./node_modules/immutable/dist/immutable.js");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(e){s(t,e);function t(){i(this,t);return a(this,e.apply(this,arguments))}t.createFromUser=function e(r){return new t({objectID:r.uid,displayName:r.displayName,bio:r.bio,photoURL:r.photoURL})};t.deserialize=function e(r){return new t(r)};t.prototype.serialize=function e(){var t=this.objectID,r=this.displayName,n=this.bio,o=this.photoURL;return{objectID:t,displayName:r,bio:n,photoURL:o}};n(t,[{key:"index",get:function e(){return t.INDEX}}],[{key:"INDEX",get:function e(){return"users"}}]);return t}((0,o.Record)({objectID:"",displayName:"",bio:"",photoURL:""}));t.default=u},"./core/models/Version.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var i,a;var s=r("./node_modules/limax/lib/limax.js");var u=y(s);var c=r("./node_modules/immutable/dist/immutable.js");var l=r("./core/models/database/index.js");var f=r("./core/models/GitHubCommitState.js");var p=y(f);var d=r("./core/models/Page.js");var h=y(d);function y(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function v(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=(a=i=function(e){v(t,e);function t(){m(this,t);return b(this,e.apply(this,arguments))}t.pathFromUid=function e(t){return t.replace(/\//g,"%2F")};t.uidFromPath=function e(t){return t.replace(/%2F/g,"/")};t.create=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r instanceof t)return r;var n=r.page||h.default.create();return new t({ref:r.ref||n.path,title:r.title||"",github:r.github?p.default.create(r.github):null,page:n})};t.createVersions=function e(r){return(0,c.OrderedMap)(r.map(function(e){var r=t.create(e);return[r.ref,r]}))};t.createInitialVersion=function e(r){return t.create({ref:r||"master",title:r||"1.0.0",page:h.default.create({title:"Initial page",path:"master"})})};t.createInitialVersions=function e(){var t;var r=this.createInitialVersion();return(0,c.OrderedMap)((t={},t[r.uid]=r,t))};t.deserialize=function e(r){var n=h.default.deserializeTree(r);var o=r.ref||n.path;if(!o)throw new Error("Missing ref to deserialize a Version");return t.create({ref:o,title:r.title,page:n,github:r.github?p.default.deserialize(r.github):null})};t.deserializeVersions=function e(r){return(0,c.OrderedMap)(Array.isArray(r)?r.map(function(e,t){return[t,e]}):r).mapEntries(function(e){var r=e[0],n=e[1];var o=t.deserialize(n);return[o.uid,{index:n.index,version:o}]}).sortBy(function(e){var t=e.index;return t}).map(function(e){var t=e.version;return t})};t.serializeVersions=function e(t){return t.mapEntries(function(e,t){var r=e[0],o=e[1];return[(0,l.escapeKey)(o.uid),n({index:t},o.serialize())]}).toObject()};t.normalizeRef=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"undefined";var n=(0,u.default)(t,{tone:false,separateNumbers:false,custom:{".":".","/":"/","+":"+"}}).slice(0,100);return n||r};t.getRef=function e(r,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;var i=o>0?n+"-"+o:n;return r.has(i)?t.getRef(r,n,o+1):i};t.prototype.serialize=function e(){return n({ref:this.ref,title:this.title,github:this.github?this.github.serialize():null},this.page.serializeTree())};t.prototype.setPage=function e(t){return this.updatePage(t,function(e){return t})};t.prototype.updatePage=function e(t,r){return this.set("page",this.page.updatePage(t,r))};t.prototype.updateRef=function e(r,n){return this.set("ref",t.getRef(r,n))};o(t,[{key:"uid",get:function e(){return this.ref}},{key:"path",get:function e(){return t.pathFromUid(this.ref)}}]);return t}((0,c.Record)({ref:"",title:"",page:h.default.create(),github:null})),i.REF_LIMIT=100,a);t.default=g},"./node_modules/@gitbook/slate-edit-list/dist/handlers/onBackspace.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});r("./node_modules/@gitbook/slate/lib/slate.es.js");var n=r("./node_modules/@gitbook/slate-edit-list/dist/changes/index.js");var o=r("./node_modules/@gitbook/slate-edit-list/dist/utils/index.js");function i(e,t,r,i){var a=t.value;var s=a.startOffset,u=a.selection;if(u.isExpanded)return;if(s>0)return;var c=(0,o.getCurrentItem)(i,a);if(!c)return;if(!u.isAtStartOf(c))return;e.preventDefault();return(0,n.unwrapList)(i,t)}t.default=i},"./node_modules/@gitbook/slate-edit-list/dist/handlers/onEnter.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});r("./node_modules/@gitbook/slate/lib/slate.es.js");var n=r("./node_modules/@gitbook/slate-edit-list/dist/changes/index.js");var o=r("./node_modules/@gitbook/slate-edit-list/dist/utils/index.js");function i(e,t,r,i){if(e.shiftKey)return;var a=t.value;var s=(0,o.getCurrentItem)(i,a);if(!s)return;e.preventDefault();a.isExpanded&&t.delete();if(s.isEmpty){if((0,o.getItemDepth)(i,a)>1)return(0,n.decreaseItemDepth)(i,t);return(0,n.unwrapList)(i,t)}return(0,n.splitListItem)(i,t)}t.default=i},"./node_modules/@gitbook/slate-edit-list/dist/handlers/onTab.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});r("./node_modules/@gitbook/slate/lib/slate.es.js");var n=r("./node_modules/@gitbook/slate-edit-list/dist/changes/index.js");var o=r("./node_modules/@gitbook/slate-edit-list/dist/utils/index.js");function i(e,t,r,i){var a=t.value;var s=a.isCollapsed;if(!s||!(0,o.getCurrentItem)(i,a))return;if(e.shiftKey){e.preventDefault();return(0,n.decreaseItemDepth)(i,t)}e.preventDefault();return(0,n.increaseItemDepth)(i,t)}t.default=i},"./node_modules/babel-runtime/core-js/object/assign.js":function(e,t,r){e.exports={default:r("./node_modules/babel-runtime/node_modules/core-js/library/fn/object/assign.js"),__esModule:true}},"./node_modules/babel-runtime/node_modules/core-js/library/fn/object/assign.js":function(e,t,r){r("./node_modules/babel-runtime/node_modules/core-js/library/modules/es6.object.assign.js");e.exports=r("./node_modules/babel-runtime/node_modules/core-js/library/modules/_core.js").Object.assign},"./node_modules/babel-runtime/node_modules/core-js/library/modules/_object-assign.js":function(e,t,r){"use strict";var n=r("./node_modules/babel-runtime/node_modules/core-js/library/modules/_object-keys.js");var o=r("./node_modules/babel-runtime/node_modules/core-js/library/modules/_object-gops.js");var i=r("./node_modules/babel-runtime/node_modules/core-js/library/modules/_object-pie.js");var a=r("./node_modules/babel-runtime/node_modules/core-js/library/modules/_to-object.js");var s=r("./node_modules/babel-runtime/node_modules/core-js/library/modules/_iobject.js");var u=Object.assign;e.exports=!u||r("./node_modules/babel-runtime/node_modules/core-js/library/modules/_fails.js")(function(){var e={};var t={};var r=Symbol();var n="abcdefghijklmnopqrst";e[r]=7;n.split("").forEach(function(e){t[e]=e});return 7!=u({},e)[r]||Object.keys(u({},t)).join("")!=n})?function e(t,r){var u=a(t);var c=arguments.length;var l=1;var f=o.f;var p=i.f;while(c>l){var d=s(arguments[l++]);var h=f?n(d).concat(f(d)):n(d);var y=h.length;var m=0;var b;while(y>m)p.call(d,b=h[m++])&&(u[b]=d[b])}return u}:u},"./node_modules/babel-runtime/node_modules/core-js/library/modules/es6.object.assign.js":function(e,t,r){var n=r("./node_modules/babel-runtime/node_modules/core-js/library/modules/_export.js");n(n.S+n.F,"Object",{assign:r("./node_modules/babel-runtime/node_modules/core-js/library/modules/_object-assign.js")})},"./node_modules/btoa/index.js":function(e,t,r){(function(t){(function(){"use strict";function r(e){var r;r=e instanceof t?e:new t(e.toString(),"binary");return r.toString("base64")}e.exports=r})()}).call(t,r("../node_modules/buffer/index.js").Buffer)},"./node_modules/glob-to-regexp/index.js":function(e,t){e.exports=function(e,t){if("string"!==typeof e)throw new TypeError("Expected a string");var r=String(e);var n="";var o=!!t&&!!t.extended;var i=!!t&&!!t.globstar;var a=false;var s=t&&"string"===typeof t.flags?t.flags:"";var u;for(var c=0,l=r.length;c<l;c++){u=r[c];switch(u){case"\\":case"/":case"$":case"^":case"+":case".":case"(":case")":case"=":case"!":case"|":n+="\\"+u;break;case"?":if(o){n+=".";break}case"[":case"]":if(o){n+=u;break}case"{":if(o){a=true;n+="(";break}case"}":if(o){a=false;n+=")";break}case",":if(a){n+="|";break}n+="\\"+u;break;case"*":var f=r[c-1];var p=1;while("*"===r[c+1]){p++;c++}var d=r[c+1];if(i){var h=p>1&&("/"===f||void 0===f)&&("/"===d||void 0===d);if(h){n+="(?:[^/]*(?:/|$))*";c++}else n+="[^/]*"}else n+=".*";break;default:n+=u}}s&&~s.indexOf("g")||(n="^"+n+"$");return new RegExp(n,s)}},"./node_modules/is-email/lib/index.js":function(e,t,r){"use strict";var n=/.+\@.+\..+/;function o(e){return n.test(e)}e.exports=o},"./node_modules/jwt-decode/lib/index.js":function(e,t,r){"use strict";var n=r("./node_modules/jwt-decode/lib/base64_url_decode.js");function o(e){this.message=e}o.prototype=new Error;o.prototype.name="InvalidTokenError";e.exports=function(e,t){if("string"!==typeof e)throw new o("Invalid token specified");t=t||{};var r=true===t.header?0:1;try{return JSON.parse(n(e.split(".")[r]))}catch(e){throw new o("Invalid token specified: "+e.message)}};e.exports.InvalidTokenError=o}});
//# space-part-39.ba8d0613.js.map